---
layout: post
title: What is IMAP and how does it work?
date: 2025-02-16
summary: IMAP - Internet Message Access Protocol - is protocol that is used for accessing e-mail from server. IMAP allow user to access email from different locations at the same time, which means that you can access you email with computer, and mobile at the same time.
categories: protocol imap networking
---


### What is protocol?
A protocol is a set of rules and conventions that govern the communication and interaction between different entities, such as computers, devices, or software applications. [1]

### What is IMAP?
IMAP - Internet Message Access Protocol -  was designed by Mark Crispin in 1986 as a remote access mailbox protocol, in contrast to the widely used POP,
a protocol for simply retrieving the contents of a mailbox. [2]

IMAP is protocol that is used for accessing e-mail on server. IMAP allow user to access email from different locations at the same time, which means that you can access you email with computer, and mobile at the same time. This couldn't be done with POP (Post Office Protocol) which would download email at the one place from where we access it and delete from server.

## IMAP versions

There is five versions of IMAP so far. 
* First version IMAP Original was released in 1986. 
* IMAP2
* IMAP3
* IMAP2bis
* IMAP4

In this post, we will explore IMAP version 4 rev1. Request for comment (RFC) can be found [here](https://datatracker.ietf.org/doc/html/rfc3501){:target="_blank"}


### Client-server architecture

IMAP protocol is based on client-server architecture. Client is one who is starting communication. Each command between client and server is prefixed with identifier, called "tag", for example short string `A0001`. Except string command can be prefixed with `+` or `*` character. 
Character `+` means that the instance is ready to get more data from source, and `*` tag means that the response is <i>untagged</i>. This means that this data doesn't have specific command associate with it. If server needs to send update for mailbox to the client it can use `*` for tag part of message, since it's not associate with any client command.

<figure style="margin: 0; margin-bottom: 1em;">
<img src="/images/imap_client_server.png" alt="IMAP client-server architecture" style="border-radius: 0.4em;">
<figcaption style="color: #777;">IMAP client-server architecture.</figcaption>
</figure>

But, more real scenario would looks something like this, with more clients contacting one server. 


<figure style="margin: 0; margin-bottom: 1em;">
<img src="/images/imap_clients_server.png" alt="IMAP clients-server architecture" style="border-radius: 0.4em;">
<figcaption style="color: #777;">IMAP client-server architecture.</figcaption>
</figure>

Server completion response can be:
* OK - success
* NO - failure
* BAD - protocol error

Connection between client and server can be in four states:
* NOT AUTHENTICATED
* AUTHENTICATE
* SELECTED
* LOGOUT

Based on this state there is different set of commands that can be used by client and server. For example client command CAPABILITY can be used in ANY connection state.

```latex
CAPABILITY command
Arguments:	none
Response:	REQUIRED untagged response: CAPABILITY 
Result:		OK - success
		BAD - command unknown or arguments invalid

```

---
1 - Internet <br>
2 - [Wikipedia](https://en.wikipedia.org/wiki/Internet_Message_Access_Protocol)